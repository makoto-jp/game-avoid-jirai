# 地雷除去ゲーム


## 初め方

### 1. ゲーム一覧を取得する

```
GET /minefields
```
で遊べる地雷原の一覧を取得します。
各地雷原の `field_id` を使ってゲームを開始します。

### ゲームを開始する

```
POST /sessions
{
  "field_id": "遊びたい地雷原のid"
}
```

でゲームを開始。成功すると

```
{
  "session_id": {unique_session_id},
  "status": {
    "code": 0,
    "text" "still alive"
  },
  "state": [
    [ -1, -1, -1],
    [ -1, -1, -1],
    [ -1, -1, -1]
  ]
}
```
のようなレスポンスが返ってきます。 `session_id` はゲームの進行に必要なので忘れないように。
"state" には 地雷原の状態が 数値の配列 で表されます。数値の意味は

* -2: 地雷 (ゲームオーバー/クリア時のみ出てきます)
* -1: わからない (touch可能)
*  0以上: 周りのマスの地雷数 (touch不要)

ゲームを開始後は

```
PUT /sessions/:session_id/touch
{
  position: [ 1, 2 ]
}
```

のようにして各マスを開いていきます。positionの1つ目の要素が縦軸、2つ目が横軸のインデックスを意味します。
地雷を踏んでいなければ

```
{
  "session_id": {unique_session_id},
  "status": {
    "code": 0,
    "text" "still alive"
  },
  "state": [
    [ -1, -1, -1],
    [ -1, -1,  2],
    [ -1, -1, -1]
  ]
}
```
のように開いたマスに周りの地雷数が記載された状態が返ります。

地雷を踏んだ場合は
```
{
  "session_id": {unique_session_id},
  "status": {
    "code": -1,
    "text" "game over"
  },
  "state": [
    [ -1, -2, -1],
    [ -2, -1, -2],
    [ -1, -1, -1]
  ]
}
```
のようになり、 `status.code` が -1 となります。
全ての地雷以外のマスを開く(touch)するとゲーム終了となり `status.code` が 1 で返ります。

ゲームクリアまたはゲームオーバーとなるとセッションは即座に削除されます。
